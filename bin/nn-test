from betbot.neural.MLP import MLP
from betbot.neural.functions.ReLu import ReLu
from betbot.neural.layer.FullyConnectedLayer import FullyConnectedLayer
from betbot.neural.data.LabelledData import LabelledData


layers = [
    FullyConnectedLayer(4, 10, ReLu(), True),
    FullyConnectedLayer(10, 4, ReLu(), True),
    FullyConnectedLayer(4, 1, ReLu(), True),
]
mlp = MLP(layers, None)

data = []
for i in range(1, 10):
    for j in range(1, 10):
        if i > j:
            continue
        data.append(LabelledData([float(i), float(j), float(i), float(j)], [i / j]))
multiple_data = []
for i in range(100):
    multiple_data += data

print("GO!")

mlp.train(
    multiple_data,
    0.01,
    50
)
mlp.save_model("/home/hermann/git/betbot/test.json")
print(mlp.classify([1.0, 2.0, 3.0, 4.0]))